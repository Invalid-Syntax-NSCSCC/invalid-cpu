#!/usr/bin/env bash

ARGS='-O=dedup --dedup --disable-annotation-unknown --add-vivado-ram-address-conflict-synthesis-bug-workaround --disable-all-randomization --lowering-options disallowLocalVariables --split-verilog -o build/final/'

# Workaround
for arg do
  shift
  case $arg in
    (-disable-infer-rw) : ;;
        (*) set -- "$@" "$arg" ;;
  esac
done

if [[ "$OSTYPE" == "darwin"* ]]; then
    firtool_darwin -O=release --dedup --disable-annotation-unknown --add-vivado-ram-address-conflict-synthesis-bug-workaround --disable-all-randomization --lowering-options disallowLocalVariables --split-verilog -o build/final/ "$@"
else
    firtool_ubuntu2004 -O=debug --dedup --disable-annotation-unknown --add-vivado-ram-address-conflict-synthesis-bug-workaround --disable-all-randomization --lowering-options disallowLocalVariables --split-verilog -o build/final/ "$@"
fi
